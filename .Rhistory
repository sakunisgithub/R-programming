chicks_data <- read.csv("D:\\data_sets\\doe_prac_q1_data.csv", stringsAsFactors = TRUE)
View(chicks_data)
dim(chicks_data)
library(tidyverse)
chicks_data %>%
ggplot(aes(x = feed, y = gain_in_weight)) +
stat_boxplot("geom" = "errorbar", linewidth = 1) +
geom_boxplot(fill = "#DD0FF1") +
labs(x = "Feed", y = "Gain in Weight", title = "Boxplot - Gain in Weight vs Feed")
chiks_data %>%
ggplot(aes(sample = gain_in_weight)) +
geom_qq(size = 2, col = "blue") +
geom_qq_line(linewidth = 1, col = "red") +
labs(x = "Theoretical Quantiles", y = "Sample Quantiles", title = "Normal Q-Q Plot")
chicks_data %>%
ggplot(aes(sample = gain_in_weight)) +
geom_qq(size = 2, col = "blue") +
geom_qq_line(linewidth = 1, col = "red") +
labs(x = "Theoretical Quantiles", y = "Sample Quantiles", title = "Normal Q-Q Plot")
homo_test <- bartlett.test(gain_in_weight ~ feed, data = chicks_data)
homo_test
chicks_data_aov <- aov(gain_in_weight ~ feed, data = chicks_data)
summary(chicks_data_aov)
TukeyHSD(chicks_data_aov, ordered = TRUE)
df1 <- chicks_data %>%
group_by(feed) %>%
summarise(row_totals = sum(gain_in_weight), row_total_sq = row_totals^2, row_total_sq_by_ni = row_total_sq / 5)
view(df1)
View(df1)
G <- sum(chicks_data$gain_in_weight)
G
CF <- G^2 / length(chicks_data$gain_in_weight)
CF
RSS <- sum(chicks_data$gain_in_weight^2)
RSS
TSS <- RSS - CF
TSS
SS_due_to_feed <- sum(df1$row_total_sq_by_ni) - CF
SS_due_to_feed
SSE <- TSS - SS_due_to_feed
SSE
MS_due_to_feed <- SS_due_to_feed / 3
MS_due_to_feed
MSE <- SSE / 16
MSE
VR <- MS_due_to_feed / MSE
VR
VR > qF(0.05, 3, 16)
qnorm(0.05)
qF
VR > qf(0.05, 3, 16)
VR > qf(0.05, 3, 16, lower.tail = FALSE)
VR > qf(0.05, 3, 16, lower.tail = TRUE)
qf(0.05, 3, 16, lower.tail = FALSE)
qf(0.05, 3, 16, lower.tail = TRUE)
qf(0.05, 3, 16, lower.tail = FALSE)
VR > qf(0.05, 3, 16, lower.tail = FALSE)
TukeyHSD(chicks_data_aov, ordered = TRUE)
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed$diff
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed-diff
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed
TukeyHSD(chicks_data_aov, ordered = TRUE)
?TukeyHSD()
critical_difference <- qt(0.025, 16, lower.tail = FALSE) * sqrt((2 * MSE) / 5)
critical_difference
MSE
qt(0.025, 16, lower.tail = FALSE)
df1 <- chicks_data %>%
group_by(feed) %>%
summarise(row_totals = sum(gain_in_weight), row_means = mean(gain_in_weight), row_total_sq = row_totals^2, row_total_sq_by_ni = row_total_sq / 5)
View(df1)
outer(df1$row_means, df1$row_means, FUN = "-")
TukeyHSD(chicks_data_aov, ordered = TRUE)
?outer
unique(abs(outer()))
a <- outer(df1$row_means, df1$row_means, FUN = "-")
unique(abs(a)
unique(abs(a))
unique(abs(a))
unique(c(abs(a)))
a <- outer(df1$row_means, df1$row_means, FUN = "-")
b <- unique(c(abs(a)))
b
which(b > critical_difference)
c <- which(b > critical_difference)
b[c]
TukeyHSD(chicks_data_aov, ordered = TRUE)
TukeyHSD(chicks_data_aov, ordered = TRUE)
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed[diff]
x <- TukeyHSD(chicks_data_aov, ordered = TRUE)$feed
filter(x, diff)
filter(x, diff > 10)
x %>%
filter(diff > 10)
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed
class(TukeyHSD(chicks_data_aov, ordered = TRUE)$feed)
class(TukeyHSD(chicks_data_aov, ordered = TRUE))
feed
class(TukeyHSD(chicks_data_aov, ordered = TRUE)$feed)
class(TukeyHSD(chicks_data_aov, ordered = TRUE)$feed[1])
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed[1]
TukeyHSD(chicks_data_aov, ordered = TRUE)$feed[,1]
# a <- outer(df1$row_means, df1$row_means, FUN = "-")
# b <- unique(c(abs(a)))
# b
# c <- which(b > critical_difference)
# b[c]
mean_differences <- TukeyHSD(chicks_data_aov)$feed[,1]
mean_differences
which(mean_differences > critical_difference)
imp <- which(mean_differences > critical_difference)
mean_differences(imp)
imp <- which(mean_differences > critical_difference)
mean_differences(imp)
mean_differences
mean_differences[imp]
imp
mean_differences[imp]
chicks_data <- read.csv("D:\\data_sets\\doe_prac_q1_data.csv", stringsAsFactors = TRUE)
View(chicks_data)
dim(chicks_data)
library(tidyverse)
chicks_data %>%
ggplot(aes(x = feed, y = gain_in_weight)) +
stat_boxplot("geom" = "errorbar", linewidth = 1) +
geom_boxplot(fill = "#DD0FF1") +
labs(x = "Feed", y = "Gain in Weight", title = "Boxplot - Gain in Weight vs Feed")
chicks_data %>%
ggplot(aes(sample = gain_in_weight)) +
geom_qq(size = 2, col = "blue") +
geom_qq_line(linewidth = 1, col = "red") +
labs(x = "Theoretical Quantiles", y = "Sample Quantiles", title = "Normal Q-Q Plot")
homo_test <- bartlett.test(gain_in_weight ~ feed, data = chicks_data)
homo_test
chicks_data_aov <- aov(gain_in_weight ~ feed, data = chicks_data)
summary(chicks_data_aov)
TukeyHSD(chicks_data_aov, ordered = TRUE)
df1 <- chicks_data %>%
group_by(feed) %>%
summarise(row_totals = sum(gain_in_weight), row_means = mean(gain_in_weight), row_total_sq = row_totals^2, row_total_sq_by_ni = row_total_sq / 5)
View(df1)
G <- sum(chicks_data$gain_in_weight)
G
CF <- G^2 / length(chicks_data$gain_in_weight)
CF
RSS <- sum(chicks_data$gain_in_weight^2)
RSS
TSS <- RSS - CF
TSS
SS_due_to_feed <- sum(df1$row_total_sq_by_ni) - CF
SS_due_to_feed
SSE <- TSS - SS_due_to_feed
SSE
sum(df1$row_total_sq)
sum(df1$row_total_sq_by_ni)
MS_due_to_feed <- SS_due_to_feed / 3
MS_due_to_feed
MSE <- SSE / 16
MSE
VR <- MS_due_to_feed / MSE
VR
chicks_data_aov <- aov(gain_in_weight ~ feed, data = chicks_data)
summary(chicks_data_aov)
VR > qf(0.05, 3, 16, lower.tail = FALSE)
qf(0.05, 3, 16, lower.tail = FALSE)
critical_difference <- qt(0.025, 16, lower.tail = FALSE) * sqrt((2 * MSE) / 5)
critical_difference
# a <- outer(df1$row_means, df1$row_means, FUN = "-")
# b <- unique(c(abs(a)))
# b
# c <- which(b > critical_difference)
# b[c]
mean_differences <- TukeyHSD(chicks_data_aov)$feed[,1]
mean_differences
imp <- which(mean_differences > critical_difference)
imp
mean_differences[imp]
our_data <- read.csv("D:\\data_sets\\doe_prac_q5_data.csv", stringsAsFactors = TRUE)
class(our_data)
View(our_data)
dim(our_data)
names(our_data)
summary(our_data)
library(tidyverse)
#normality test
our_data %>%
ggplot(aes(sample = yield)) +
stat_qq(size = 2, col = "red") +
stat_qq_line(linewidth = 1, col = "blue") +
labs(x = "Theoretical Quantiles", y = "Sample Quantiles", title = "Normal Q-Q Plot")
shapiro.test(our_data$yield)
our_data %>%
ggplot(aes(x = village, y = yield)) +
stat_boxplot(geom = "errorbar") +
geom_boxplot(fill = "#DB2AF0", linewidth = 1) +
labs(x = "Villages", y = "Yield", title = "Boxplot of Yield vs Villages")
our_data %>%
ggplot(aes(x = treatment, y = yield)) +
stat_boxplot(geom = "errorbar") +
geom_boxplot(fill = "#0CECAF", linewidth = 1) +
labs(x = "Treatment", y = "Yield", title = "Boxplot of Yield vs Treatments")
our_data_anova <- aov(yield ~ village + treatment, data = our_data)
summary(our_data_anova)
yield_adjusted <- (our_data$yield - 500) / 10
yield_adjusted
adjusted_data <- our_data
adjusted_data$yield_adjusted <- yield_adjusted
View(adjusted_data)
G <- sum(adjusted_data$yield_adjusted)
G
CF <- G^2 / length(adjusted_data$yield_adjusted)
CF
RSS <- sum(adjusted_data$yield_adjusted^2)
RSS
(RSS - CF)
TSS <- (RSS - CF) * 10^2
TSS
df1 <- adjusted_data %>%
group_by(village) %>%
summarise(row_total = sum(yield_adjusted), row_total_sq = row_total^2)
View(df1)
df2 <- adjusted_data %>%
group_by(treatment) %>%
summarise(column_total = sum(yield_adjusted), column_total_sq = column_total^2)
View(df2)
sum(df1$row_total_sq)
sum(df2$column_total_sq)
SSvillage <- (sum(df1$row_total_sq) / 4 - CF) * 10^2
SSvillage
SStreatments <- (sum(df2$column_total_sq) / 3 - CF) * 10^2
SStreatments
SSE <- TSS - SSvillage - SStreatments
SSE
MSvillage <- SSvillage / 2
MSvillage
MStreatments <- SStreatments / 3
MStreatments
MSE <- SSE / 6
MSE
MStreatments / MSE
summary(our_data_anova)
qf(0.05, 3, 6, lower.tail = FALSE)
critical_difference <- qt(0.025, 6, lower.tail = FALSE) * sqrt((2 * MSE)/3)
critical_difference
a <- TukeyHSD(our_data_anova)$treatment[,1]
a
TukeyHSD(our_data_anova)
chicks_data <- read.csv("D:\\data_sets\\doe_prac_q1_data.csv", stringsAsFactors = TRUE)
chicks_data_aov <- aov(gain_in_weight ~ feed, data = chicks_data)
summary(chicks_data_aov)
# a <- outer(df1$row_means, df1$row_means, FUN = "-")
# b <- unique(c(abs(a)))
# b
# c <- which(b > critical_difference)
# b[c]
mean_differences <- TukeyHSD(chicks_data_aov)$feed[,1]
mean_differences
TukeyHSD(chicks_data_aov, ordered = TRUE)
?TukeyHSD
a <- TukeyHSD(our_data_anova, ordered = TRUE)$treatment[,1]
a
df_temp <- our_data %>%
group_by(treatment) %>%
summarise(column_total = sum(yield), column_mean = mean(yield))
View(df)
View(df)
View(df_temp)
df_3 <- our_data %>%
group_by(treatment) %>%
summarise(column_total = sum(yield), column_mean = mean(yield))
View(df_3)
a <- TukeyHSD(our_data_anova, ordered = TRUE)$treatment[,1]
a
a <- TukeyHSD(our_data_anova)$treatment[,1]
a
critical_difference <- qt(0.025, 6, lower.tail = FALSE) * sqrt((2 * MSE)/3)
critical_difference
which(abs(a) > critical_difference)
our_data <- read.csv("D:\\data_sets\\doe_prac_q6_data.csv", stringsAsFactors = TRUE)
View(our_data)
dim(our_data)
names(our_data)
summary(our_data)
which(is.na(our_data))
na.rm(our_data)
library(tidyverse)
all_known_obs <- our_data %>%
drop_na()
all_known_obs
View(all_known_obs)
df1 <- all_known_obs %>%
group_by(block) %>%
summarise(row_total = sum(response))
View(df1)
df2 <- all_known_obs %>%
group_by(treatment) %>%
summarise(column_total = sum(response))
View(df2)
which(is.na(our_data$response))
summary(our_data)
x_hat <- (4 * df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs$response)) / (3 * 2)
x_hat
adjusted_data <- our_data
adjusted_data$response[which(is.na(adjusted_data$response))] = x_hat
View(adjusted_data)
G <- sum(adjusted_data$response)
G
CF <- G^2 / length(adjusted_data$response)
CF
RSS <- sum(adjusted_data$response^2)
RSS
TSS <- RSS - CF
TSS
df3 <- adjusted_data %>%
group_by(block) %>%
summarise(row_total = sum(response), row_total_sq = row_total^2)
View(df3)
df4 <- adjusted_data %>%
group_by(treatment) %>%
summarise(column_total = sum(response), column_total_sq = column_total^2)
View(df4)
sum(df3$row_total_sq)
SSblocks <- (sum(df3$row_total_sq) / 3) - CF
SSblocks
adjustment_factor <- (df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs))^2 / (3 * 2 * 3^2)
df1$row_total[2]
df2$column_total[1]
3 * df2$column_total[1]
df1$row_total[2] + 3 * df2$column_total[1]
df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs)
df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs)
adjustment_factor <- (df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs$response))^2 / (3 * 2 * 3^2)
adjustment_factor
sum(df4$column_total_sq)
SStreatments <- (sum(df4$column_total_sq) / 4) - CF
SStreatments
SStreatments_adjusted <- SStreatments - adjustment_factor
SStreatments_adjusted
SSE <- TSS - SStreatments_adjusted - SSblocks
SSE
MSblocks <- SSblocks / 3
MSblocks
MStreatments_adjusted <- SStreatments_adjusted / 2
MStreatments_adjusted
MSE <- SSE / 5
MSE
MStreatments_adjusted / MSE
qf(0.05, 2, 5, lower.tail = FALSE)
our_data <- read.csv("D:\\data_sets\\doe_prac_q6_data.csv", stringsAsFactors = TRUE)
View(our_data)
dim(our_data)
names(our_data)
summary(our_data)
which(is.na(our_data$response))
library(tidyverse)
all_known_obs <- our_data %>%
drop_na()
View(all_known_obs)
df1 <- all_known_obs %>%
group_by(block) %>%
summarise(row_total = sum(response))
View(df1)
df2 <- all_known_obs %>%
group_by(treatment) %>%
summarise(column_total = sum(response))
View(df2)
sum(all_known_obs$response)
df1$row_total[2]
df2$column_total[1]
x_hat <- (4 * df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs$response)) / (3 * 2)
x_hat
adjusted_data <- our_data
adjusted_data$response[which(is.na(adjusted_data$response))] = x_hat
View(adjusted_data)
G <- sum(adjusted_data$response)
G
CF <- G^2 / length(adjusted_data$response)
CF
RSS <- sum(adjusted_data$response^2)
RSS
TSS <- RSS - CF
TSS
df3 <- adjusted_data %>%
group_by(block) %>%
summarise(row_total = sum(response), row_total_sq = row_total^2)
View(df3)
df4 <- adjusted_data %>%
group_by(treatment) %>%
summarise(column_total = sum(response), column_total_sq = column_total^2)
View(df4)
sum(df3$row_total_sq)
sum(df4$column_total_sq)
SSblocks <- (sum(df3$row_total_sq) / 3) - CF
SSblocks
SStreatments <- (sum(df4$column_total_sq) / 4) - CF
SStreatments
adjustment_factor <- (df1$row_total[2] + 3 * df2$column_total[1] - sum(all_known_obs$response))^2 / (3 * 2 * 3^2)
adjustment_factor
SStreatments_adjusted <- SStreatments - adjustment_factor
SStreatments_adjusted
SSE <- TSS - SStreatments - SSblocks
SSE
SSE <- TSS - SStreatments_adjusted - SSblocks
SSE
SSE <- TSS - SStreatments - SSblocks
SSE
MSblocks <- SSblocks / 3
MSblocks
MStreatments_adjusted <- SStreatments_adjusted / 2
MStreatments_adjusted
MSE <- SSE / 5
MSE
MStreatments_adjusted / MSE
qf(0.05, 2, 5, lower.tail = FALSE)
